# roguelike 

[![Build Status](https://travis-ci.com/Gammanik/bash.svg?branch=master)](https://travis-ci.com/Gammanik/bash.svg?branch=master)

roguelike game on kotlin


### Архитектурное описание


При старте игры игроку предлагается загрузить карту из файла, либо играть на случайно сгенерированной карте. 

За это отвечает класс `LoadMapMenu`, который для загрузки карты из файла использует `JFileChooser` из библиотеки `Swing`.  

Kласс `Map` отвечает за карту. Он состоит из точек класса `MapPoint`.

`GamePanel` - главное окно взаимодействия. В этом классе написана логика отрисовки персонажа и взаимодействие с клавиатурой.
При нажатии кнопок *WASD* у персонажа обновляются координаты и при ререндеринге он отрисовывается уже в другом месте.

За игрока отвечает интерфейс `Character`, от которого есть базовая реализация игрока `Player`, а есть абстрактный класс
декоратора `PlayerDecorator`, имплементация которого (`ConfusionSpellDecorator`) отвечает за заклинание конфузии, которое
временно накладывается на игрока при перемещении на соответствующую клетку карты.

Мобы(класс `Mob`), как и персонаж, реализуют интерфейс `GameUnit` для движения по карте. При нахождении в радиусе атаки
игрок клавишей `ENTER` может атаковать мобов, а они будут атаковать его. Есть три вида мобов по поведению, это
реализовано с помощью паттерна стратегия посредством абстрактного класса `BehaviourStrategy`, три имплементации которого
соответствуют трем разным поведениям.

Для проверки возможности движения по карте существует класс `MapChecker`, в котором есть функции проверки возможности
движения.

Для возможности сохранения и запуска игры используется сериализация и десериализация, для которых есть адаптеры,
позволяющие менять логику сериализации и десериализации. Классы-адаптеры находятся в пакете com.roguelike.saving и
реализованы для `Character`, `Mob`, `GameMap`, `ItemBase`, `GamePanel`. Чтобы сохранить игру, нажмите `T`.

За информационную панель отвечает класс `InfoMenuPanel`, в котором отображается уровень, количество здоровья и опыта,
предметы из инвентаря.

За предметы отвечает абстрактный класс `ItemBase`, имплементации которого `AidItem`, `PoisonItem` и `PowerUpItem`
соответствуют трем различным предметам, которые можно найти и подобрать на карте. Для использования предмета нажмите `E`,
чтобы выбросить предмет, нажмите `F`. Надевание вещей происходит так же по клавише
 `E`. Чтобы переключаться по предметам, используйте `Q`, для доступа к нужному предмету,
нажмите клавишу `1..8`, соответствующую нужному предмету.

#### Диаграмма классов
![rogue classes](./rogClasses.png)

#### Диаграмма компонентов
![states](./diagrams/componentsDiagram.png)

Основные компоненты:
`Подсистема инициализации`: в ней происходит инициализация игры. В ней инициализируются `подсистема отображения`,
`главное игровое поле`, `поле игровой информации`. Для того, чтобы она смогла проинициализировать главное игровое окно,
используется подсистема инициализации карты. После того, как игра проинициализирована, логика сконцентрирована
в `главном игровом поле`, которое отвечает за игровую карту, игровые объекты и их состояние, взаимодействие 
с пользователем, и в `поле игровой иноформации`, которое отвечает за отображение пользователю текущего состояния: 
уровня здоровья, опыта, уровня, предметов инвентаря. За отрисовку на экране обоих этих полей отвечает `подсистема
отображения`.

&nbsp;
#### Игровой процесс:
![rogue classes](./game_screen.jpg)



#### Диаграммы состояний моба и игры
![states](./diagrams/states.png)
